<?xml version="1.0"?>
    <openerp>
        <data>
            <template id="website_apiform_2" inherit_id="website.assets_frontend" name="website_apiform" >
                <xpath expr="/t" position="inside">
                    <link rel="stylesheet" href="/web/static/lib/jquery.ui.bootstrap/css/custom-theme/jquery-ui-1.9.0.custom.css"/>
                    <t t-call="web.jqueryui_conflict">
                        <script type="text/javascript" src="/web/static/lib/jquery.ui/js/jquery-ui-1.9.1.custom.js"></script>
                    </t>
                    <link rel="stylesheet" href="/web/static/lib/jquery.ui.timepicker/css/jquery-ui-timepicker-addon.css"/>
                    <link rel="stylesheet" href="/ept_carga_proyectos/static/src/css/ept_cp_carga_proyecto.css"/>
                    <script type="text/javascript" src="/web/static/lib/jquery.ui.timepicker/js/jquery-ui-timepicker-addon.js"></script>
                    <script type="text/javascript" src="/ept_carga_proyectos/static/src/js/ept_carga_proyecto.js"/>
                    <script type="text/javascript" src="/ept_carga_proyectos/static/src/js/ept_carga_proyecto_ayudas.js"/>
                    <script type="text/javascript" src="/ept_carga_proyectos/static/src/js/ept_vaidar_fecha.js"/>
                    <script type="text/javascript" src="/ept_carga_proyectos/static/src/js/ept_clonar_elemntos_tr.js"/>
                    <script type="text/javascript" src="/ept_carga_proyectos/static/src/js/ept_alcaldias_asociadas.js"/>
                    <script type="text/javascript" src="/ept_carga_proyectos/static/src/js/solicitud_cambio.js"/>
                    <script type="text/javascript" src="/ept_rendicion/static/src/js/ept_lista_proyectos.js"/>
                </xpath>
            </template>

<!--
template para  listar los proyectos creados
-->
        <template id="ept_carga_proyectos.proyecto_template" name="Template para listar los proyectos">
            <a href="/proyecto/crear">
                <button type="button"  t-attf-class="btn btn-info glyphicon glyphicon-folder-open #{ocultar_boton_crear(partner_id)}"> Crear</button>
            </a>
            <br/>
            <br/>
            <div t-if="mensaje_migrados" class="alert alert-danger"><h2 t-esc="mensaje_migrados"/></div>
            <t t-if="gobernacion=='gobernacion'">
                <ul class="nav nav-tabs">
                  <li id="proyectos_entidad" class="active" data-toggle="tab"><a href="/proyecto">Proyectos</a></li>
                  <li id="proyectos_alcaldia" data-toggle="tab"><a href="alcaldias">Proyectos de Alcaldías Asociadas</a></li>
                </ul>
            </t>
            <t t-if="alcaldia=='alcaldia'">
                <ul class="nav nav-tabs">
                  <li id="proyectos_entidad" class="active" data-toggle="tab"><a href="/proyecto">Proyectos</a></li>
                  <li id="proyectos_gobernacion" data-toggle="tab"><a href="gobernacion">Proyectos de la Gobernación</a></li>
                </ul>
            </t>
            
            <input type='hidden' id="domain" t-att-value="'%s' % (domain)"/>
            <div class="tab-content" id="tabla_proyectos">
                <div class="" id="entidades">
                    <t t-if="len(proyectos_ids)>0">
                        <table class="table table-bordered table-striped mt32">
                            <thead>
                                <tr>
                                    <th>N#</th>
                                    <th class="col-md-3">Códigoww de Proyecto</th>
                                    <th class="col-md-5">Nombre del Proyecto</th>
                                    <th class="col-md-2">Monto de Proyecto</th>
                                    <th class="col-md-2">Estatus</th>
                                </tr>
                            </thead>
                            <tbody id="proyectos_completos">
                                <t t-set="cont" t-value="1" />
<!--
                                <t t-foreach="carga_proyecto_data" t-as="proyecto">
                                    <tr class="active" >
                                        <td><t t-esc='cont'/></td>
                                        <td ><a t-att-href="url_for('/proyecto/lectura/%s' % (proyecto['id']))" ><t t-esc="proyecto['correlativo']"/></a> <img t-attf-src="#{ocultar_proyecto_editado(proyecto['id'])}"/> </td>
                                        <td t-att-class="'limitar_caracteres_%s' % (cont)" align="justify"><t t-esc="proyecto['nombre_proyecto']"/></td>
                                        <td class="monto"><t t-esc="dict_montos[proyecto['id']]"/></td>
                                        <td >
                                            <t t-if="proyecto['state']=='aprobado'">
                                                <t t-set="bcss" t-value="info"/>
                                                <t t-call="ept_carga_proyectos.bontonEstadoAprobado"/>
                                            </t>
                                            <t t-if="proyecto['state']=='negado'">
                                                <button type="button" class="btn btn-xs btn-default btn-block" ><span class="glyphicon glyphicon-remove-circle"  /> Negado</button>
                                            </t>
                                            <t t-if="proyecto['state']=='evaluacion'">
                                                <button type="button" class="btn btn-xs btn-default btn-block"  ><span class="glyphicon glyphicon-pencil" /> Evaluación</button>
                                            </t>
                                            <t t-if="proyecto['state']=='cancelado'">
                                                <button type="button" class="btn btn-xs btn-default btn-block" ><span class="glyphicon glyphicon-hand-down" /> Cancelado</button>
                                            </t>
                                            <t t-if="proyecto['state']=='carga'">
                                                <button type="button" class="btn btn-xs btn-default btn-block"  ><span class="glyphicon glyphicon-list-alt" /> Borrador</button>
                                            </t>
                                            <t t-if="proyecto['state']=='diferido'">
                                                <button type="button" class="btn btn-xs btn-default btn-block" ><span class="glyphicon glyphicon-refresh" /> Diferido</button>
                                            </t>
                                            <t t-if="proyecto['state']=='culminado'">
                                                <t t-set="bcss" t-value="info"/>
                                                <t t-call="ept_carga_proyectos.bontonEstadoCulminado"/>
                                            </t>
                                        </td>
                                    </tr>
                                    <t t-set="cont" t-value="cont+1" />
                               </t>
-->
                            </tbody>
                        </table>
                        </t>
                    <br/>
                    <br/>
                    <t t-if="len(proyectos_ids)==0">
                        <div id="proyecto_no" class="alert alert-info">
                            <p>
                                Presione el boton de CREAR para cargar un nuevo proyecto.
                            </p>
                        </div>
                    </t>
                </div>
                    
<!--
                    vista de alcaldia asociadas a la gobernación
-->
                    
                    <div class="hidden" id="alcaldias">
                        <br/>
                        <br/>
                        <div class="panel panel-default">
                            <div class="panel-heading">Alcaldias Asociadas</div>
                            <div class="panel-body">
                                <select class="form-control" id="alcaldias_asociadas" name="alcaldias_asociadas" mensaje="Alaldias Asociadas" required="required">
                                    <option class="hidden" selected="true" value=''>Seleccione la Alcaldia</option>
                                    <t t-foreach="partner_asociados_data" t-as="partner">
                                        <option t-att-value="'%s' % (partner.id)"><t t-esc="partner.name"/></option>
                                    </t>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="proyectos_asociados">
                        <div class="here_table">
                        </div>
                    </div>
            
<!--
                    vista de los proyectos de las gobernaciones ejecutados dentro de una alcaldía
-->
            
                <div class="hidden" id="gobernacion">
                    <t t-if="len(proyectos_gobenacion_data)>0">
                    <table class="table table-bordered table-striped mt32">
                        <thead>
                            <tr>
                                <th class="col-md-3">Código de Proyecto</th>
                                <th class="col-md-5">Nombre del Proyecto</th>
                                <th class="col-md-2">Monto de Proyecto</th>
                                <th class="col-md-2">Estatus</th>
                            </tr>
                        </thead>
                        <tbody id="proyectos_completos">
                            <t t-set="cont" t-value="1" />
                            <t t-foreach="proyectos_gobenacion_data" t-as="proyecto_gobernacion">
                                <tr class="active" >
                                    <td ><a t-att-href="url_for('/proyecto/lectura/%s' % (proyecto_gobernacion['id']))" ><t t-esc="proyecto_gobernacion['correlativo']"/></a></td>
                                    <td t-att-class="'limitar_caracteres_%s' % (cont)" align="justify"><t t-esc="proyecto_gobernacion['nombre_proyecto']"/></td>
                                    <td class="monto"><t t-esc="dict_montos_asoci[proyecto_gobernacion.id]"/></td>
                                    <td >
                                        <t t-if="proyecto_gobernacion['state']=='aprobado'">
                                            <button type="button" class="btn btn-xs btn-default btn-block"  ><span class="glyphicon glyphicon-pencil" /> Aprobado</button>
                                        </t>
                                        <t t-if="proyecto_gobernacion['state']=='negado'">
                                            <button type="button" class="btn btn-xs btn-default btn-block" ><span class="glyphicon glyphicon-remove-circle"  /> Negado</button>
                                        </t>
                                        <t t-if="proyecto_gobernacion['state']=='evaluacion'">
                                            <button type="button" class="btn btn-xs btn-default btn-block"  ><span class="glyphicon glyphicon-pencil" /> Evaluación</button>
                                        </t>
                                        <t t-if="proyecto_gobernacion['state']=='cancelado'">
                                            <button type="button" class="btn btn-xs btn-default btn-block" ><span class="glyphicon glyphicon-hand-down" /> Cancelado</button>
                                        </t>
                                        <t t-if="proyecto_gobernacion['state']=='carga'">
                                            <button type="button" class="btn btn-xs btn-default btn-block"  ><span class="glyphicon glyphicon-list-alt" /> Borrador</button>
                                        </t>
                                        <t t-if="proyecto_gobernacion['state']=='diferido'">
                                            <button type="button" class="btn btn-xs btn-default btn-block" ><span class="glyphicon glyphicon-refresh" /> Diferido</button>
                                        </t>
                                        <t t-if="proyecto_gobernacion['state']=='culminado'">
                                            <button type="button" class="btn btn-xs btn-default btn-block" ><span class="glyphicon glyphicon-flag" /> Culminado</button>
                                        </t>
                                    </td>
                                </tr>
                                <t t-set="cont" t-value="cont+1" />
                           </t>
                        </tbody>
                    </table>
                    </t>
                </div>
                <br/>
                <br/>
                <t t-if="alcaldia=='alcaldia'">
                    <t t-if="len(proyectos_gobenacion_data)==0">
                        <div id="mensaje_sin_proyecto" class="alert alert-info hidden">
                            <p>
                                Las Gobernación no tiene proyectos aprobados en su Municipio.
                            </p>
                        </div>
                    </t>
                </t>
            </div>
        </template>
        
<!--
        template para el estado aprobado de los proyectos
-->

        <template id="ept_carga_proyectos.bontonEstadoAprobado">
            <div class="btn-group" >
                
                <t t-set="tiempo_validez" t-value="self.tiempo_validez_get(proyecto['id'])"/>
                <t t-set="cancelar_proyecto" t-value="self.cancelar_proyecto_get(proyecto['id'])"/>
                <t t-set="reporte_ejecucion" t-value="self.rendicion_proyecto_get(proyecto['id'])"/>
                <button type="button" t-att-class="'btn btn-xs btn-%s' % (tiempo_validez) "><span class="glyphicon glyphicon-check" />Aprobado</button>
                    <button type="button" t-att-class="'btn btn-xs btn-%s dropdown-toggle' % (tiempo_validez)" data-toggle="dropdown">
                        <span class="caret"></span>
                        <span class="sr-only">Desplegar menú</span>
                    </button>
                     <ul class="dropdown-menu" t-if="rendir">
                        <li>
                            <a t-att-href="url_for('/avance/%s/' % proyecto['id'])">
                                <h5><span class="glyphicon glyphicon-arrow-right"/>Avance</h5>
                            </a>
                        </li>
                        <li>
                            <a t-att-href="url_for('/avance/%s/' % proyecto['id'])">
                                <h5><span class="glyphicon glyphicon-ok" />Culminación</h5>
                            </a>
                        </li>
                        <t t-if="cancelar_proyecto">
                        <li><a t-att-href="url_for('/cancelar/%s/' % proyecto['id'])">
                                <h5><span class="glyphicon glyphicon-remove" />Cancelar</h5>
                            </a>
                        </li>
                        </t>
                        <t t-if="reporte_ejecucion">
                        <li><a t-att-href="url_for('/descargar/reporte_ejecucion/%s/' % proyecto['id'])">
                                <h5><span class="glyphicon glyphicon-download" />Reporte de Ejecución</h5>
                            </a>
                        </li>
                        </t>
                    </ul>
            </div>
        </template>
        
        
        <template id="ept_carga_proyectos.bontonEstadoCulminado">
            <div class="btn-group" >
                <button type="button" t-att-class="'btn btn-xs btn-primary'" ><span class="glyphicon glyphicon-check" />Culminado</button>
                    <button type="button" t-att-class="'btn btn-xs btn-primary dropdown-toggle'" data-toggle="dropdown">
                        <span class="caret"></span>
                        <span class="sr-only">Desplegar menú</span>
                    </button>
                     <ul class="dropdown-menu" t-if="rendir">
                        <li>
                            <a t-att-href="url_for('/avance/consultar/%s/' % proyecto['id'])">
                                <h5><span class="glyphicon glyphicon-check"/>Consultar Avances</h5>
                            </a>
                        </li>
                        <li>
                            <a t-att-href="url_for('/descargar/reporte_ejecucion/%s/' % proyecto['id'])">
                                <h5><span class="glyphicon glyphicon-download"/>Reporte de Ejecución</h5>
                            </a>
                        </li>
                    </ul>
            </div>
        </template>
        
        <template id="ept_carga_proyectos.bontonEstadoOtros">
            <div class="btn-group">
                <button type="button" t-attf-class="btn btn-%-#{bcss}" ><span class="glyphicon glyphicon-list-alt" />Borrador</button>
            </div>
        </template>
    </data>
</openerp>


